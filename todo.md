# 车规功率芯片MRP系统需求与目标规划

## 项目背景
基于车规功率芯片（50KA和10LL）的历史数据（2024年1月-7月），建立动态MRP（物料需求计划）系统，实现精准的库存管理和订单预测。

## 核心目标
1. **提高预测准确度** - 通过历史数据分析，量化预测误差，建立可靠的预测模型
2. **优化库存水平** - 实现动态安全库存计算，平衡库存成本与服务水平
3. **自动化订单决策** - 基于科学模型自动计算月度订单量，减少人工决策偏差

## 数据概览

### 产品信息
- **LD公司 - 50KA产品**
  - 数据周期：1月-7月实际数据 + 全年预测数据
  - 关键指标：期初库存、订货量、收货数量、交货数量、期末库存
  
- **B公司 - 10LL产品**  
  - 数据周期：1月-7月实际数据
  - 关键指标：同上

### 关键参数设定
- **服务水平系数(Z)**: 1.65 (对应95%服务水平)
- **供货周期(LT)**: 1.5个月（基于历史数据分析）
- **审视周期(P)**: 1个月（月度下单）

## 功能需求

### 1. 数据处理模块
**需求描述**: 将Excel原始数据转换为可计算的结构化格式

**具体任务**:
- [ ] 解析rawdata.txt中的表格数据
- [ ] 建立数据模型，区分预测数据和实际数据
- [ ] 数据清洗：处理空值、异常值
- [ ] 创建时间序列数据结构，便于后续分析

**输出**:
- 结构化的JSON/DataFrame格式数据
- 数据质量报告（缺失值、异常值统计）

### 2. 预测误差分析模块
**需求描述**: 衡量历史预测准确度，为安全库存计算提供基础

**核心公式**:
```
预测误差 = 预测发货量 - 实际发货量
```

**具体任务**:
- [ ] 计算每月预测误差
- [ ] 计算月平均误差(Bias)，识别系统性偏差
- [ ] 计算预测误差的标准差(σ_error)
- [ ] 生成误差分析报告

**预期结果示例**:
| 产品 | 月平均误差(Bias) | 预测误差标准差(σ_error) | 解读 |
|------|-----------------|------------------------|------|
| 50KA | -X.XX千件 | XX.XX千件 | 系统性低估/高估分析 |
| 10LL | +X.XX千件 | XX.XX千件 | 波动性分析 |

### 3. 动态安全库存计算模块
**需求描述**: 基于预测误差动态计算安全库存

**核心公式**:
```latex
SS_t = Z × σ_error,t × √(LT_t)
```

**具体任务**:
- [ ] 实现滚动窗口计算σ_error（建议12个月窗口）
- [ ] 动态更新供货周期LT（基于最近3-5批订单）
- [ ] 计算每个产品的安全库存值
- [ ] 建立安全库存趋势分析

**动态更新机制**:
- 月度更新预测误差标准差
- 季度审视服务水平系数
- 实时跟踪供货周期变化

### 4. 月度订单量计算模块
**需求描述**: 实现定期盘点系统的订单量自动计算

**核心公式**:

**步骤1 - 目标库存水位**:
```latex
M = D_(P+LT) + SS_(P+LT)
其中: SS_(P+LT) = Z × σ_error,t × √(P + LT_t)
```

**步骤2 - 最终下单量**:
```latex
Q_t = M - I_t - O_t
```

**具体任务**:
- [ ] 计算未来(P+LT)期间的总预测需求
- [ ] 计算覆盖风险周期的安全库存
- [ ] 获取当前库存状态（手头库存+在途库存）
- [ ] 计算并验证订单量（负值处理）
- [ ] 生成订单建议报告

**参数说明**:
- P+LT = 2.5个月（1个月审视周期 + 1.5个月供货周期）
- I_t = 当前实际库存
- O_t = 在途库存

### 5. 可视化与报告模块
**需求描述**: 提供直观的数据展示和决策支持

**具体任务**:
- [ ] 库存水平趋势图（实际vs目标）
- [ ] 预测误差时间序列图
- [ ] 安全库存动态变化图
- [ ] 订单量建议仪表板
- [ ] 月度MRP计划报告自动生成

**报告内容**:
1. 执行摘要（关键指标汇总）
2. 预测准确度分析
3. 当前库存状态评估
4. 下月订单建议及理由
5. 风险提示（供应链异常、需求波动等）

## 实施计划

### 第一阶段：数据基础（第1-2周）
- 完成数据处理模块
- 建立基础数据结构
- 生成数据质量报告

### 第二阶段：核心计算（第3-4周）
- 实现预测误差分析
- 完成安全库存计算
- 开发订单量计算逻辑

### 第三阶段：系统集成（第5-6周）
- 集成各模块功能
- 建立自动化流程
- 系统测试与优化

### 第四阶段：可视化与部署（第7-8周）
- 开发可视化界面
- 生成自动化报告
- 用户培训与上线

## 成功标准

### 定量指标
1. **预测准确度提升**: 预测误差标准差降低15%以上
2. **库存周转率改善**: 提高20%以上
3. **缺货率降低**: 控制在5%以内
4. **库存成本优化**: 降低10-15%

### 定性指标
1. **决策效率**: 订单决策时间从天级降至分钟级
2. **透明度提升**: 全流程可追溯、可解释
3. **风险预警**: 提前识别供应链风险
4. **用户满意度**: 操作简便，结果可信

## 技术栈建议

### 后端
- Python (pandas, numpy, scipy) - 数据处理与计算
- SQLite/PostgreSQL - 数据存储
- FastAPI - API服务

### 前端
- React/Vue.js - 用户界面
- ECharts/D3.js - 数据可视化
- Ant Design/Element UI - UI组件库

### 部署
- Docker - 容器化部署
- GitHub Actions - CI/CD
- 云服务（阿里云/AWS）- 生产环境

## 风险与应对

### 技术风险
- **数据质量问题**: 建立数据验证机制，异常值自动标记
- **模型准确性**: 定期回测，持续优化参数

### 业务风险
- **需求突变**: 增加异常检测，人工干预接口
- **供应链中断**: 建立多供应商模型，风险分散

### 实施风险
- **用户接受度**: 渐进式推广，保留人工审核环节
- **系统集成**: 标准化接口，分阶段集成

## 下一步行动
1. 确认需求细节和优先级
2. 搭建开发环境
3. 开始数据处理模块开发
4. 建立项目进度跟踪机制

---

*文档版本: 1.0*  
*创建日期: 2024*  
*最后更新: 待定*
